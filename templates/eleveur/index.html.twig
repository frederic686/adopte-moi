{% extends 'base.html.twig' %}

{% block title %}Mon profil éleveur{% endblock %}

{% block content %}
  <h1>Profil de {{ user.nom }}</h1>

  <div class="profil">
    <img src="{{ user.photo ?: '/uploads/avatars/default.png' }}" 
         alt="Photo de profil" 
         style="width:120px;height:120px;object-fit:cover;border-radius:50%">
    <p><strong>Email :</strong> {{ user.email }}</p>
    <p><strong>Ville :</strong> {{ user.ville ?: 'Non renseignée' }}</p>
  </div>

  <hr>

  <h2>Mes annonces</h2>

  {% if animaux is empty %}
    <p>Aucun animal publié pour l’instant.</p>
  {% else %}
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px;">
      {% for animal in animaux %}
        <div style="border:1px solid #ddd;border-radius:10px;overflow:hidden;box-shadow:0 2px 5px rgba(0,0,0,0.1);background:#fff;">
          
          {# ✅ Photo #}
          {% if animal.photo %}
            <img src="{{ animal.photo }}" alt="{{ animal.nom }}" style="width:100%;height:180px;object-fit:cover;">
          {% else %}
            <div style="width:100%;height:180px;display:flex;align-items:center;justify-content:center;background:#f3f4f6;color:#888;">
              Pas de photo
            </div>
          {% endif %}

          <div style="padding:15px;">
            <h3 style="margin:0 0 10px;">{{ animal.nom }}</h3>
            <p style="margin:0;font-size:14px;color:#555;">
              <strong>Type :</strong> {{ animal.type.categorie }}<br>
              <strong>Race :</strong> {{ animal.race }}<br>
              <strong>Âge :</strong> {{ animal.age }} ans
            </p>

            <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
              <a href="{{ path('app_animal_show', {id: animal.id}) }}" style="padding:6px 10px;border-radius:6px;background:#3b82f6;color:white;text-decoration:none;font-size:14px;">👁️ Voir</a>
              <a href="{{ path('app_animal_edit', {id: animal.id}) }}" style="padding:6px 10px;border-radius:6px;background:#f59e0b;color:white;text-decoration:none;font-size:14px;">✏️ Modifier</a>
              <form method="post"
                    action="{{ path('app_animal_delete', {id: animal.id}) }}"
                    onsubmit="return confirm('Supprimer cet animal ?');"
                    style="display:inline;">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ animal.id) }}">
                <button style="padding:6px 10px;border-radius:6px;background:#ef4444;color:white;border:none;cursor:pointer;font-size:14px;">🗑️ Supprimer</button>
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <p style="margin-top:20px;">
    <a href="{{ path('app_animal_new') }}" style="padding:10px 15px;background:#10b981;color:white;border-radius:8px;text-decoration:none;">➕ Publier un nouvel animal</a>
  </p>
{% endblock %}
